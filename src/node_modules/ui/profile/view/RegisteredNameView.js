import React from 'react';
import { connect } from 'react-redux';
import PropType from 'prop-types';

import { Button, Loading, RegisteredName } from "ui/control";
import { isRegisteredNameDefined, isRegisteredNameManageable } from "state/registeredname/selectors";

const ManagementButtonsImpl = ({manageable, nameDefined}) => {
    if (!manageable) {
        return null;
    }
    return (
        <div className="col-sm-10">
            <Button variant="outline-secondary" size="sm">
                Change
            </Button>
            <Button variant={!nameDefined ? "primary" : "outline-secondary"} size="sm" style={{marginLeft: "0.2rem"}}>
                Register New
            </Button>
            {nameDefined &&
                <Button variant="primary" size="sm" style={{marginLeft: "0.2rem"}}>
                    Prolong
                </Button>
            }
        </div>
    );
};

const ManagementButtons = connect(
    state => ({
        manageable: isRegisteredNameManageable(state),
        nameDefined: isRegisteredNameDefined(state)
    })
)(ManagementButtonsImpl);

const RegisteredNameView = ({loading, name, generation}) => (
    <>
        <h4>
            Registered Name <Loading active={loading} />
        </h4>
        <div className="row">
            {name &&
                <div className="col-sm-2">
                    <RegisteredName name={name} generation={generation}/>
                </div>
            }
            <ManagementButtons />
        </div>
    </>
);

RegisteredNameView.propTypes = {
    name: PropType.string,
    generation: PropType.number
};

export default connect(
    state => ({
        loading: state.registeredName.loading,
        name: state.registeredName.name,
        generation: state.registeredName.generation
    })
)(RegisteredNameView);
