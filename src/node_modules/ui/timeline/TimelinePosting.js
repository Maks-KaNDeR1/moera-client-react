import React from 'react';
import { connect } from 'react-redux';
import moment from 'moment';

import { goToPosting } from "state/navigation/actions";
import "./Posting.css";

class TimelinePosting extends React.PureComponent {

    constructor(props) {
        super(props);

        this.onClick = this.onClick.bind(this);
    }

    onClick(e) {
        this.props.goToPosting(this.props.posting.id);
        e.preventDefault();
    }

    render() {
        const {posting, rootLocation} = this.props;

        return (
            <div className="posting" data-moment={posting.moment}>
                <a className="date" href={`${rootLocation}/post/${posting.id}`} onClick={this.onClick}>
                    {moment.unix(posting.created).format("DD-MM-YYYY HH:mm")}
                </a>
                <div className="content" dangerouslySetInnerHTML={{__html: posting.bodyHtml}}/>
            </div>
        );
    }

}

export default connect(
    state => ({
        rootLocation: state.node.root.location,
    }),
    { goToPosting }
)(TimelinePosting);
