import { conj, inv, trigger } from "state/trigger";
import { CONNECTED_TO_HOME, DISCONNECT_FROM_HOME } from "state/home/actions";
import { GO_TO_PAGE } from "state/navigation/actions";
import { isAtProfilePage } from "state/navigation/selectors";
import { isRegisteredNameToBeLoaded } from "state/registeredname/selectors";
import {
    REGISTER_NAME_SUCCEEDED,
    REGISTERED_NAME_UPDATE_SUCCEEDED,
    registeredNameLoad,
    registeredNameUnset
} from "state/registeredname/actions";
import { EVENT_NODE_REGISTERED_NAME_CHANGED, EVENT_NODE_REGISTERED_NAME_OPERATION_STATUS } from "api/events/actions";

export default [
    trigger(GO_TO_PAGE, conj(isAtProfilePage, isRegisteredNameToBeLoaded), registeredNameLoad),
    trigger([CONNECTED_TO_HOME, DISCONNECT_FROM_HOME], isAtProfilePage, registeredNameLoad),
    trigger([CONNECTED_TO_HOME, DISCONNECT_FROM_HOME], inv(isAtProfilePage), registeredNameUnset),
    trigger(REGISTER_NAME_SUCCEEDED, true, registeredNameLoad),
    trigger(REGISTERED_NAME_UPDATE_SUCCEEDED, true, registeredNameLoad),
    trigger(
        [EVENT_NODE_REGISTERED_NAME_OPERATION_STATUS, EVENT_NODE_REGISTERED_NAME_CHANGED],
        isAtProfilePage,
        registeredNameLoad
    ),
    trigger(
        [EVENT_NODE_REGISTERED_NAME_OPERATION_STATUS, EVENT_NODE_REGISTERED_NAME_CHANGED],
        inv(isAtProfilePage),
        registeredNameUnset
    )
];
