import { conj, trigger } from "state/trigger";
import { GO_TO_PAGE, scrollLocation } from "state/navigation/actions";
import { isAtTimelinePage } from "state/navigation/selectors";
import { TIMELINE_SCROLLED, timelineGeneralLoad } from "state/timeline/actions";
import { isTimelineContainsMoment, isTimelineGeneralToBeLoaded } from "state/timeline/selectors";
import { EVENT_NODE_POSTING_ADDED, EVENT_NODE_POSTING_RESTORED } from "api/events/actions";
import { postingLoad } from "state/postings/actions";

export default [
    trigger(GO_TO_PAGE, conj(isAtTimelinePage, isTimelineGeneralToBeLoaded), timelineGeneralLoad),
    trigger(TIMELINE_SCROLLED, true, scrollLocation),
    trigger(
        [EVENT_NODE_POSTING_ADDED, EVENT_NODE_POSTING_RESTORED],
        (state, signal) => isTimelineContainsMoment(state, signal.payload.moment),
        signal => postingLoad(signal.payload.id)
    )
];
