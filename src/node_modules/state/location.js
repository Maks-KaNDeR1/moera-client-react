import { PAGE_TIMELINE } from "state/navigation/pages";
import { goToPage } from "state/navigation/actions";
import { isAtTimelinePage, isAtProfilePage } from "state/navigation/selectors";
import { transform as profileTransform, build as profileBuild } from "state/profile/location";
import { atOwner } from "util/util";

export function transform(srcInfo, dstInfo) {
    if (dstInfo.directories.length === 0) {
        if (srcInfo.directories.length !== 0) {
            return [goToPage(PAGE_TIMELINE)];
        }
        return [];
    }
    if (dstInfo.directories[0] === "timeline") {
        return [goToPage(PAGE_TIMELINE)];
    }
    if (dstInfo.directories[0] === "profile") {
        return profileTransform(srcInfo, dstInfo);
    }
    return [];
}

export function build(state, info) {
    if (isAtTimelinePage(state)) {
        return info.sub("timeline").withTitle("Timeline" + atOwner(state));
    }
    if (isAtProfilePage(state)) {
        return profileBuild(state, info);
    }
    return info;
}
