#!/bin/sh

SERVER_CONFIG=node_modules/react-scripts/config/webpackDevServer.config.js

if ! grep -q 'Access-Control-Allow-Origin' $SERVER_CONFIG; then
    patch $SERVER_CONFIG <<'END'
@@ -36,6 +36,7 @@
     // So we will disable the host check normally, but enable it if you have
     // specified the `proxy` setting. Finally, we let you override it if you
     // really know what you're doing with a special environment variable.
+    headers: {'Access-Control-Allow-Origin': '*'},
     disableHostCheck:
       !proxy || process.env.DANGEROUSLY_DISABLE_HOST_CHECK === 'true',
     // Enable gzip compression of generated files.
END
fi

yarn start
